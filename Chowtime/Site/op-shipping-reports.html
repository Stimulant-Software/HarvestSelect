<!doctype html>
<html lang="en">
    <head>
        <title>Harvest Select Dashboards</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.3.1/fullcalendar.min.css">
        <link rel="stylesheet" type="text/css" href="content/HarvestSelectDashboards.css">
        <link href="content/global.css" rel="stylesheet" type="text/css">
    </head>
    <body class="op op-report">
        <header>
        <h1>Shipping Report</h1>
        <nav>
            <ol>
                <li class="bol"><a href="op-shipping-reports.html">Shipping Reports</a></li>
                <li class="username">Logged in as <span id="userName"></span> (<a id="logoutButton">logout</a>)</li>
            </ol>
        </nav>
    </header>
        <section id="mainContent" class="container">
			<section class="row date-select text-center">
			  <table class="table table-sm table-striped">
                  <tr><th>Item</th>
                  <th>Description</th>
                  <th>Customer</th>
                  <th>D0</th>
                  <th>D1</th>
                  <th>D2</th>
                  <th>D3</th>
                  <th>D4</th>
                  <th>D5</th>
                  <th>D6</th>
                  <th>D7</th>
                  <th>Order Amount</th>
                  <th>Starting QOH</th>
                  <th>Production</th>
                  <th>Shipped</th>
                  </tr>
                  <tbody id="shippingBody"></tbody>
              </table>
			</section>
        </section>

       <footer></footer>
        
        <!--<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css">-->
        <script src="scripts/underscore.min.js"></script>
        <script src="scripts/moment.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment-with-locales.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.3.1/fullcalendar.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/highcharts-3d.js"></script>
        <script src="http://code.highcharts.com/modules/data.js"></script>
        <script src="scripts/moment.js"></script>
        <script type="text/javascript" src="scripts/functions.js"></script>
        <script>
            var authorized = false, superAuthorized = false, userRoles = localStorage['CTuserRole'].split(' ');
            if (userRoles.indexOf('Operations') > -1) authorized = true;
            if (userRoles.indexOf('Operations') > -1) { authorized = true; superAuthorized = true; }
            if (!authorized) window.location.href = "login.html";
            $.when(checkKey(), pageLabel()).then(function () {
                shippingFrozen();
            });
            
            function shippingFrozen() {

                //$('#submitBOL').unbind().click(function (e) {
                //    e.preventDefault();
                //    openBolReport();
                //}
                //);
                //function openBolReport() {
                showProgress('body');
                searchQuery = { "Key": _key }, data = JSON.stringify(searchQuery);

                $.ajax('../api/Reports/GetShippingReportFrozen', {
                    type: 'POST',
                    data: data,
                    success: function (msg) {
                        var rowHTML = "";
                        var itemCodes = {};
                        for (var i = 0; i < msg.ShippingTotals.length; i++) {
                            var itemCode = msg.ShippingTotals[i].ItemCode;
                            if (!itemCodes[itemCode]) {
                                itemCodes[itemCode] = [];
                            }
                            itemCodes[itemCode].push(msg.ShippingTotals[i]);
                        } 
                        
                        itemCodes.forEach(function (thing, index) {
                            var customerOrders = {};
                            for (var j = 0; j < thing.length; j++) {
                            var cOrder = thing[j].CustomerName;
                            if (!customerOrders[cOrder]) {
                                customerOrders[cOrder] = [];
                            }
                            customerOrders[cOrder].push(thing[j]);
                            } 
                            if (index == 0) {
                                rowHTML += '<tr><th>' + thing[0].ItemCode + '</th>';
                                rowHTML += '<th>' + thing[0].ItemCode + '</th>';
                                rowHTML += '<th>' + thing[0].ItemCode + '</th>';
                                rowHTML += '<th>D0</th>';
                                rowHTML += '<th>D1</th>';
                                rowHTML += '<th>D2</th>';
                                rowHTML += '<th>D3</th>';
                                rowHTML += '<th>D4</th>';
                                rowHTML += '<th>D5</th>';
                                rowHTML += '<th>D6</th>';
                                rowHTML += '<th>D7</th>';
                                rowHTML += '<th>Order Amount</th>';
                                rowHTML += '<th>Starting QOH</th>';
                                rowHTML += '<th>Production</th>';
                                rowHTML += '<th>Shipped</th></tr>';
                            };

                        });
                        //msg.ShippingTotals.forEach(function (item) {
                            
                            
                            
                        //});
                        $('#shippingBody').append(rowHTML);
                        hideProgress();
                    }
                });
                //}

            }
        </script>
    </body>
</html>